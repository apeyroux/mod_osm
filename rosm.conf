<VirtualHost *:80>
	     ServerAdmin webmaster@localhost
	     ServerName osm.intra

	     LoadModule osm_module /usr/lib/apache2/modules/mod_osm.so
	     OsmEnabled true
	     OsmMbtilesPath "/var/www/osmfr-z0-z14.mbtiles"

	     ProxyRequests On
	     ProxyRemote * http://10.226.148.239:80

	     <Proxy balancer://pxy_osmfr_cluster>
	     	BalancerMember http://a.tile.openstreetmap.fr/osmfr 
    		BalancerMember http://b.tile.openstreetmap.fr/osmfr
    		BalancerMember http://c.tile.openstreetmap.fr/osmfr
	     </Proxy>	     

	     # prise en comtpe des tiles qui ne sont pas dans le mbtiles
	     # traite les 404 (out bbox fr entre les zooms 10 et 15)
	     # si 404 alors passer par osm fr
             RewriteEngine On
             # not an existing file
             RewriteCond %{SCRIPT_FILENAME} !-f
             # not an existing directory
             RewriteCond %{SCRIPT_FILENAME} !-d
             RewriteRule ^/(\d+)/(\d+)/(\d+.png)$ http://a.tile.openstreetmap.fr/osmfr/$1/$2/$3 [P] 

	     # certainement inutile vu la règle ci dessus.
	     # les z10 à z19 passe par osmfr
	     # rgxg range -Z 15 19 
	     ProxyPassMatch ^/(1[5-9])/(\d+)/(\d+.png)$  balancer://pxy_osmfr_cluster/$1/$2/$3[1]

	     # tjrs utile suite ajout mbtiles ?
	     LoadModule cache_module modules/mod_cache.so
             <IfModule mod_disk_cache.c>
                CacheRoot /var/www/cache/apache/osm
                CacheEnable disk /
                CacheDirLevels 3
                CacheDirLength 2
             </IfModule>	       

	     <Location />
	         SetHandler osm-handler
	     </Location>
</VirtualHost>	